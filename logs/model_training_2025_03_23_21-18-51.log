2025-03-23 21:18:51,256 - INFO - Model training script started.
2025-03-23 21:18:51,262 - INFO - Processing partition: v1
2025-03-23 21:18:51,262 - INFO - Pulling dataset v1 from DVC...
2025-03-23 21:18:58,129 - INFO - Loading datasets...
2025-03-23 21:19:00,488 - INFO - Starting hyperparameter tuning...
2025-03-23 21:19:01,622 - WARNING - From C:\Users\niksh\Desktop\DA5402-Assign-5\venv\Lib\site-packages\keras\src\backend\common\global_state.py:82: The name tf.reset_default_graph is deprecated. Please use tf.compat.v1.reset_default_graph instead.

2025-03-23 21:39:32,709 - INFO - Training the best model...
2025-03-23 21:59:40,645 - INFO - Model saved to 'models/tuned_model_v1_seed84.keras'.
2025-03-23 21:59:40,650 - INFO - Evaluating the best model on the test dataset...
2025-03-23 21:59:47,027 - INFO - Classification Report:
2025-03-23 21:59:47,027 - INFO - {'airplane': {'precision': 0.7524752475247525, 'recall': 0.608, 'f1-score': 0.672566371681416, 'support': 250.0}, 'automobile': {'precision': 0.8375634517766497, 'recall': 0.66, 'f1-score': 0.738255033557047, 'support': 250.0}, 'bird': {'precision': 0.4304932735426009, 'recall': 0.384, 'f1-score': 0.4059196617336152, 'support': 250.0}, 'cat': {'precision': 0.4550898203592814, 'recall': 0.304, 'f1-score': 0.3645083932853717, 'support': 250.0}, 'deer': {'precision': 0.4911504424778761, 'recall': 0.444, 'f1-score': 0.46638655462184875, 'support': 250.0}, 'dog': {'precision': 0.6875, 'recall': 0.176, 'f1-score': 0.2802547770700637, 'support': 250.0}, 'frog': {'precision': 0.35569422776911075, 'recall': 0.912, 'f1-score': 0.5117845117845118, 'support': 250.0}, 'horse': {'precision': 0.7172995780590717, 'recall': 0.68, 'f1-score': 0.6981519507186859, 'support': 250.0}, 'ship': {'precision': 0.7092198581560284, 'recall': 0.8, 'f1-score': 0.7518796992481203, 'support': 250.0}, 'truck': {'precision': 0.7241379310344828, 'recall': 0.756, 'f1-score': 0.7397260273972602, 'support': 250.0}, 'accuracy': 0.5724, 'macro avg': {'precision': 0.6160623830699855, 'recall': 0.5724, 'f1-score': 0.5629432981097942, 'support': 2500.0}, 'weighted avg': {'precision': 0.6160623830699855, 'recall': 0.5724, 'f1-score': 0.562943298109794, 'support': 2500.0}}
2025-03-23 21:59:47,049 - INFO - Confusion Matrix:
2025-03-23 21:59:47,049 - INFO - [[152   4  10   2   9   0  20   5  34  14]
 [  3 165   1   2   1   0  32   3   9  34]
 [ 16   1  96  20  34   2  68   8   2   3]
 [  3   0  23  76  16   8 101   5  12   6]
 [  8   2  23   6 111   1  71  17   9   2]
 [  0   0  43  48  22  44  62  23   6   2]
 [  1   1   5   6   5   2 228   0   0   2]
 [  3   0  15   4  26   5  21 170   4   2]
 [ 11   8   4   2   0   0  17   1 200   7]
 [  5  16   3   1   2   2  21   5   6 189]]
2025-03-23 21:59:48,900 - INFO - Evaluation report saved to 'reports/evaluation_report_v1_seed84.json'.
2025-03-23 21:59:48,963 - INFO - Processing partition: v2
2025-03-23 21:59:48,964 - INFO - Pulling dataset v2 from DVC...
2025-03-23 21:59:57,619 - INFO - Loading datasets...
2025-03-23 21:59:59,763 - INFO - Starting hyperparameter tuning...
2025-03-23 22:33:22,056 - INFO - Training the best model...
2025-03-23 23:06:36,397 - INFO - Model saved to 'models/tuned_model_v2_seed84.keras'.
2025-03-23 23:06:36,409 - INFO - Evaluating the best model on the test dataset...
2025-03-23 23:06:47,172 - INFO - Classification Report:
2025-03-23 23:06:47,173 - INFO - {'airplane': {'precision': 0.5496894409937888, 'recall': 0.708, 'f1-score': 0.6188811188811189, 'support': 250.0}, 'automobile': {'precision': 0.6057692307692307, 'recall': 0.756, 'f1-score': 0.6725978647686833, 'support': 250.0}, 'bird': {'precision': 0.41568627450980394, 'recall': 0.424, 'f1-score': 0.4198019801980198, 'support': 250.0}, 'cat': {'precision': 0.32051282051282054, 'recall': 0.6, 'f1-score': 0.4178272980501393, 'support': 250.0}, 'deer': {'precision': 0.5459183673469388, 'recall': 0.428, 'f1-score': 0.4798206278026906, 'support': 250.0}, 'dog': {'precision': 0.4782608695652174, 'recall': 0.352, 'f1-score': 0.4055299539170507, 'support': 250.0}, 'frog': {'precision': 0.7117117117117117, 'recall': 0.632, 'f1-score': 0.6694915254237288, 'support': 250.0}, 'horse': {'precision': 0.7073170731707317, 'recall': 0.696, 'f1-score': 0.7016129032258065, 'support': 250.0}, 'ship': {'precision': 0.6960352422907489, 'recall': 0.632, 'f1-score': 0.6624737945492662, 'support': 250.0}, 'truck': {'precision': 0.8676470588235294, 'recall': 0.236, 'f1-score': 0.3710691823899371, 'support': 250.0}, 'accuracy': 0.5464, 'macro avg': {'precision': 0.5898548089694522, 'recall': 0.5464, 'f1-score': 0.5419106249206442, 'support': 2500.0}, 'weighted avg': {'precision': 0.5898548089694523, 'recall': 0.5464, 'f1-score': 0.5419106249206441, 'support': 2500.0}}
2025-03-23 23:06:47,211 - INFO - Confusion Matrix:
2025-03-23 23:06:47,212 - INFO - [[177   5  26  14   2   1   2   2  19   2]
 [  8 189   6  12   3   0  11   2  15   4]
 [ 22   0 106  41  26  25  14  13   2   1]
 [  6   0  19 150  16  33  11   7   7   1]
 [ 20   2  33  33 107  11   9  33   2   0]
 [ 10   0  22 101  10  88   4  13   1   1]
 [  0   0  24  47  12   7 158   2   0   0]
 [  8   0   7  27  16  17   0 174   1   0]
 [ 53  12  10  13   1   0   3   0 158   0]
 [ 18 104   2  30   3   2  10   0  22  59]]
2025-03-23 23:06:48,387 - INFO - Evaluation report saved to 'reports/evaluation_report_v2_seed84.json'.
2025-03-23 23:06:48,467 - INFO - Processing partition: v3
2025-03-23 23:06:48,467 - INFO - Pulling dataset v3 from DVC...
2025-03-23 23:07:04,519 - INFO - Loading datasets...
2025-03-23 23:07:06,927 - INFO - Starting hyperparameter tuning...
2025-03-23 23:18:53,990 - INFO - Training the best model...
2025-03-23 23:30:06,648 - INFO - Model saved to 'models/tuned_model_v3_seed84.keras'.
2025-03-23 23:30:06,651 - INFO - Evaluating the best model on the test dataset...
2025-03-23 23:30:15,439 - INFO - Classification Report:
2025-03-23 23:30:15,441 - INFO - {'airplane': {'precision': 0.7976190476190477, 'recall': 0.5338645418326693, 'f1-score': 0.639618138424821, 'support': 251.0}, 'automobile': {'precision': 0.7903225806451613, 'recall': 0.7808764940239044, 'f1-score': 0.7855711422845691, 'support': 251.0}, 'bird': {'precision': 0.6190476190476191, 'recall': 0.46613545816733065, 'f1-score': 0.5318181818181819, 'support': 251.0}, 'cat': {'precision': 0.5277777777777778, 'recall': 0.4541832669322709, 'f1-score': 0.48822269807280516, 'support': 251.0}, 'deer': {'precision': 0.4666666666666667, 'recall': 0.6972111553784861, 'f1-score': 0.5591054313099042, 'support': 251.0}, 'dog': {'precision': 0.6188118811881188, 'recall': 0.49800796812749004, 'f1-score': 0.5518763796909493, 'support': 251.0}, 'frog': {'precision': 0.5826086956521739, 'recall': 0.8007968127490039, 'f1-score': 0.674496644295302, 'support': 251.0}, 'horse': {'precision': 0.7, 'recall': 0.6972111553784861, 'f1-score': 0.6986027944111777, 'support': 251.0}, 'ship': {'precision': 0.7245283018867924, 'recall': 0.7649402390438247, 'f1-score': 0.7441860465116279, 'support': 251.0}, 'truck': {'precision': 0.7579365079365079, 'recall': 0.7609561752988048, 'f1-score': 0.7594433399602386, 'support': 251.0}, 'accuracy': 0.6454183266932271, 'macro avg': {'precision': 0.6585319078419866, 'recall': 0.6454183266932272, 'f1-score': 0.6432940796779576, 'support': 2510.0}, 'weighted avg': {'precision': 0.6585319078419866, 'recall': 0.6454183266932271, 'f1-score': 0.6432940796779577, 'support': 2510.0}}
2025-03-23 23:30:15,448 - INFO - Confusion Matrix:
2025-03-23 23:30:15,448 - INFO - [[134   7  14   5  21   6   8   9  38   9]
 [  4 196   2   4   4   1   3   3  14  20]
 [ 11   0 117   8  52  18  34   7   2   2]
 [  0   0  15 114  29  38  39  11   2   3]
 [  2   1   7   9 175   3  27  23   1   3]
 [  1   2  14  44  27 125  17  17   0   4]
 [  1   2   7   9  25   3 201   1   1   1]
 [  0   3  10  12  33   7   7 175   0   4]
 [  8  13   3   6   8   1   4   1 192  15]
 [  7  24   0   5   1   0   5   3  15 191]]
2025-03-23 23:30:19,339 - INFO - Evaluation report saved to 'reports/evaluation_report_v3_seed84.json'.
2025-03-23 23:30:19,463 - INFO - All partitions processed. Model training complete.
