2025-03-23 17:06:37,554 - INFO - Model training script started.
2025-03-23 17:06:37,557 - INFO - Processing partition: v1
2025-03-23 17:06:37,558 - INFO - Pulling dataset v1 from DVC...
2025-03-23 17:06:45,465 - INFO - Loading datasets...
2025-03-23 17:06:48,186 - INFO - Starting hyperparameter tuning...
2025-03-23 17:06:49,355 - WARNING - From C:\Users\niksh\Desktop\DA5402-Assign-5\venv\Lib\site-packages\keras\src\backend\common\global_state.py:82: The name tf.reset_default_graph is deprecated. Please use tf.compat.v1.reset_default_graph instead.

2025-03-23 17:12:34,273 - INFO - Training the best model...
2025-03-23 17:17:16,413 - INFO - Model saved to 'models/tuned_model_v1_seed42.keras'.
2025-03-23 17:17:16,417 - INFO - Evaluating the best model on the test dataset...
2025-03-23 17:17:20,585 - INFO - Classification Report:
2025-03-23 17:17:20,585 - INFO - {'airplane': {'precision': 0.6968325791855203, 'recall': 0.616, 'f1-score': 0.6539278131634819, 'support': 250.0}, 'automobile': {'precision': 0.89937106918239, 'recall': 0.572, 'f1-score': 0.6992665036674817, 'support': 250.0}, 'bird': {'precision': 0.5119047619047619, 'recall': 0.344, 'f1-score': 0.41148325358851673, 'support': 250.0}, 'cat': {'precision': 0.35194174757281554, 'recall': 0.58, 'f1-score': 0.4380664652567976, 'support': 250.0}, 'deer': {'precision': 0.6666666666666666, 'recall': 0.52, 'f1-score': 0.5842696629213483, 'support': 250.0}, 'dog': {'precision': 0.4572192513368984, 'recall': 0.684, 'f1-score': 0.5480769230769231, 'support': 250.0}, 'frog': {'precision': 0.8186274509803921, 'recall': 0.668, 'f1-score': 0.73568281938326, 'support': 250.0}, 'horse': {'precision': 0.6666666666666666, 'recall': 0.712, 'f1-score': 0.688588007736944, 'support': 250.0}, 'ship': {'precision': 0.7857142857142857, 'recall': 0.704, 'f1-score': 0.7426160337552743, 'support': 250.0}, 'truck': {'precision': 0.7137681159420289, 'recall': 0.788, 'f1-score': 0.7490494296577946, 'support': 250.0}, 'accuracy': 0.6188, 'macro avg': {'precision': 0.6568712595152426, 'recall': 0.6188, 'f1-score': 0.6251026912207822, 'support': 2500.0}, 'weighted avg': {'precision': 0.6568712595152426, 'recall': 0.6188, 'f1-score': 0.6251026912207822, 'support': 2500.0}}
2025-03-23 17:17:20,603 - INFO - Confusion Matrix:
2025-03-23 17:17:20,603 - INFO - [[154   2  26  22   3   7   1   3  20  12]
 [ 12 143   3  14   1   7   2   3  14  51]
 [ 10   0  86  59  18  49  12  10   3   3]
 [  2   0   6 145   8  68  10   8   2   1]
 [  3   0  19  29 130  21   8  36   3   1]
 [  0   0   5  48   6 171   3  16   0   1]
 [  1   0   8  45  14  11 167   1   2   1]
 [  2   0   4  21  12  29   1 178   0   3]
 [ 30   6   7  16   3   4   0   2 176   6]
 [  7   8   4  13   0   7   0  10   4 197]]
2025-03-23 17:17:22,510 - INFO - Evaluation report saved to 'reports/evaluation_report_v1_seed42.json'.
2025-03-23 17:17:22,546 - INFO - Processing partition: v2
2025-03-23 17:17:22,547 - INFO - Pulling dataset v2 from DVC...
2025-03-23 17:17:30,874 - INFO - Loading datasets...
2025-03-23 17:17:33,095 - INFO - Starting hyperparameter tuning...
2025-03-23 17:34:28,334 - INFO - Training the best model...
2025-03-23 17:50:34,849 - INFO - Model saved to 'models/tuned_model_v2_seed42.keras'.
2025-03-23 17:50:34,857 - INFO - Evaluating the best model on the test dataset...
2025-03-23 17:50:40,395 - INFO - Classification Report:
2025-03-23 17:50:40,395 - INFO - {'airplane': {'precision': 0.4932249322493225, 'recall': 0.728, 'f1-score': 0.5880452342487884, 'support': 250.0}, 'automobile': {'precision': 0.793859649122807, 'recall': 0.724, 'f1-score': 0.7573221757322176, 'support': 250.0}, 'bird': {'precision': 0.5023696682464455, 'recall': 0.424, 'f1-score': 0.4598698481561822, 'support': 250.0}, 'cat': {'precision': 0.6179775280898876, 'recall': 0.22, 'f1-score': 0.32448377581120946, 'support': 250.0}, 'deer': {'precision': 0.48028673835125446, 'recall': 0.536, 'f1-score': 0.5066162570888468, 'support': 250.0}, 'dog': {'precision': 0.6090225563909775, 'recall': 0.324, 'f1-score': 0.42297650130548303, 'support': 250.0}, 'frog': {'precision': 0.7443946188340808, 'recall': 0.664, 'f1-score': 0.7019027484143763, 'support': 250.0}, 'horse': {'precision': 0.5975609756097561, 'recall': 0.784, 'f1-score': 0.6782006920415224, 'support': 250.0}, 'ship': {'precision': 0.5249406175771971, 'recall': 0.884, 'f1-score': 0.6587183308494784, 'support': 250.0}, 'truck': {'precision': 0.8036529680365296, 'recall': 0.704, 'f1-score': 0.7505330490405118, 'support': 250.0}, 'accuracy': 0.5992, 'macro avg': {'precision': 0.6167290252508258, 'recall': 0.5992, 'f1-score': 0.5848668612688617, 'support': 2500.0}, 'weighted avg': {'precision': 0.6167290252508258, 'recall': 0.5992, 'f1-score': 0.5848668612688616, 'support': 2500.0}}
2025-03-23 17:50:40,411 - INFO - Confusion Matrix:
2025-03-23 17:50:40,423 - INFO - [[182   2   6   2   0   1   1   5  50   1]
 [ 29 181   1   1   0   1   0   0  15  22]
 [ 32   5 106   2  43   8  13  17  23   1]
 [ 23   6  28  55  33  32  21  20  28   4]
 [ 35   0  14   4 134   3  12  30  17   1]
 [ 14   3  25  21  23  81   9  43  26   5]
 [  5   1  27   3  21   3 166   8  13   3]
 [  9   1   2   1  25   3   0 196   8   5]
 [ 18   7   2   0   0   0   0   1 221   1]
 [ 22  22   0   0   0   1   1   8  20 176]]
2025-03-23 17:50:41,537 - INFO - Evaluation report saved to 'reports/evaluation_report_v2_seed42.json'.
2025-03-23 17:50:41,579 - INFO - Processing partition: v3
2025-03-23 17:50:41,579 - INFO - Pulling dataset v3 from DVC...
2025-03-23 17:50:48,250 - INFO - Loading datasets...
2025-03-23 17:50:50,503 - INFO - Starting hyperparameter tuning...
2025-03-23 18:09:04,352 - INFO - Training the best model...
2025-03-23 18:16:40,500 - INFO - Model saved to 'models/tuned_model_v3_seed42.keras'.
2025-03-23 18:16:40,501 - INFO - Evaluating the best model on the test dataset...
2025-03-23 18:16:43,861 - INFO - Classification Report:
2025-03-23 18:16:43,861 - INFO - {'airplane': {'precision': 0.723404255319149, 'recall': 0.5418326693227091, 'f1-score': 0.6195899772209568, 'support': 251.0}, 'automobile': {'precision': 0.8894472361809045, 'recall': 0.7051792828685259, 'f1-score': 0.7866666666666666, 'support': 251.0}, 'bird': {'precision': 0.6213592233009708, 'recall': 0.5099601593625498, 'f1-score': 0.5601750547045952, 'support': 251.0}, 'cat': {'precision': 0.5265486725663717, 'recall': 0.47410358565737054, 'f1-score': 0.4989517819706499, 'support': 251.0}, 'deer': {'precision': 0.5070821529745042, 'recall': 0.7131474103585658, 'f1-score': 0.5927152317880795, 'support': 251.0}, 'dog': {'precision': 0.6477272727272727, 'recall': 0.4541832669322709, 'f1-score': 0.5339578454332553, 'support': 251.0}, 'frog': {'precision': 0.6550632911392406, 'recall': 0.8247011952191236, 'f1-score': 0.7301587301587301, 'support': 251.0}, 'horse': {'precision': 0.762114537444934, 'recall': 0.6892430278884463, 'f1-score': 0.7238493723849372, 'support': 251.0}, 'ship': {'precision': 0.58656330749354, 'recall': 0.9043824701195219, 'f1-score': 0.7115987460815048, 'support': 251.0}, 'truck': {'precision': 0.8017241379310345, 'recall': 0.7410358565737052, 'f1-score': 0.7701863354037267, 'support': 251.0}, 'accuracy': 0.6557768924302789, 'macro avg': {'precision': 0.6721034087077922, 'recall': 0.6557768924302789, 'f1-score': 0.6527849741813102, 'support': 2510.0}, 'weighted avg': {'precision': 0.6721034087077922, 'recall': 0.6557768924302789, 'f1-score': 0.6527849741813102, 'support': 2510.0}}
2025-03-23 18:16:43,868 - INFO - Confusion Matrix:
2025-03-23 18:16:43,868 - INFO - [[136   4   9   4  14   0   4   4  69   7]
 [ 12 177   3   4   5   1   4   1  25  19]
 [ 17   0 128   9  51  10  15   5  11   5]
 [  2   1  18 119  25  36  30   9  10   1]
 [  2   1   8  11 179   5  19  18   6   2]
 [  4   1  22  45  19 114  20  15   9   2]
 [  1   0   9   6  21   2 207   2   2   1]
 [  0   1   9  20  31   7   5 173   3   2]
 [  5   3   0   4   2   1   2   0 227   7]
 [  9  11   0   4   6   0  10   0  25 186]]
2025-03-23 18:16:44,847 - INFO - Evaluation report saved to 'reports/evaluation_report_v3_seed42.json'.
2025-03-23 18:16:44,872 - INFO - Processing partition: v1+v2
2025-03-23 18:16:44,872 - INFO - Pulling dataset v1+v2 from DVC...
2025-03-23 18:16:56,175 - INFO - Loading datasets...
2025-03-23 18:17:00,152 - INFO - Starting hyperparameter tuning...
2025-03-23 18:54:38,117 - INFO - Training the best model...
2025-03-23 19:06:10,097 - INFO - Model saved to 'models/tuned_model_v1+v2_seed42.keras'.
2025-03-23 19:06:10,099 - INFO - Evaluating the best model on the test dataset...
2025-03-23 19:06:15,976 - INFO - Classification Report:
2025-03-23 19:06:15,976 - INFO - {'airplane': {'precision': 0.8078703703703703, 'recall': 0.698, 'f1-score': 0.7489270386266095, 'support': 500.0}, 'automobile': {'precision': 0.7941712204007286, 'recall': 0.872, 'f1-score': 0.8312678741658722, 'support': 500.0}, 'bird': {'precision': 0.6762402088772846, 'recall': 0.518, 'f1-score': 0.5866364665911665, 'support': 500.0}, 'cat': {'precision': 0.6370106761565836, 'recall': 0.358, 'f1-score': 0.45838668373879643, 'support': 500.0}, 'deer': {'precision': 0.557774607703281, 'recall': 0.782, 'f1-score': 0.6511240632805995, 'support': 500.0}, 'dog': {'precision': 0.6042884990253411, 'recall': 0.62, 'f1-score': 0.6120434353405726, 'support': 500.0}, 'frog': {'precision': 0.632183908045977, 'recall': 0.88, 'f1-score': 0.7357859531772575, 'support': 500.0}, 'horse': {'precision': 0.875, 'recall': 0.686, 'f1-score': 0.7690582959641256, 'support': 500.0}, 'ship': {'precision': 0.7168284789644013, 'recall': 0.886, 'f1-score': 0.7924865831842576, 'support': 500.0}, 'truck': {'precision': 0.8850574712643678, 'recall': 0.77, 'f1-score': 0.8235294117647058, 'support': 500.0}, 'accuracy': 0.707, 'macro avg': {'precision': 0.7186425440808335, 'recall': 0.7070000000000001, 'f1-score': 0.7009245805833964, 'support': 5000.0}, 'weighted avg': {'precision': 0.7186425440808334, 'recall': 0.707, 'f1-score': 0.7009245805833964, 'support': 5000.0}}
2025-03-23 19:06:15,976 - INFO - Confusion Matrix:
2025-03-23 19:06:15,976 - INFO - [[349  14  23   3  21   5   8   3  66   8]
 [  8 436   3   2   1   1   8   1  22  18]
 [ 26   5 259  19  79  37  50   3  20   2]
 [  6  12  19 179  64 109  91   9   8   3]
 [  8   2  17   7 391   9  42  15   6   3]
 [  7   2  28  47  48 310  36  11   9   2]
 [  1   3  14   6  19   9 440   2   6   0]
 [  3   5  15  12  69  30   6 343   8   9]
 [ 16  17   3   3   6   0   5   2 443   5]
 [  8  53   2   3   3   3  10   3  30 385]]
2025-03-23 19:06:17,163 - INFO - Evaluation report saved to 'reports/evaluation_report_v1+v2_seed42.json'.
2025-03-23 19:06:17,212 - INFO - Processing partition: v1+v2+v3
2025-03-23 19:06:17,212 - INFO - Pulling dataset v1+v2+v3 from DVC...
2025-03-23 19:06:28,141 - INFO - Loading datasets...
2025-03-23 19:06:33,956 - INFO - Starting hyperparameter tuning...
2025-03-23 20:30:11,562 - INFO - Training the best model...
2025-03-23 20:58:19,286 - INFO - Model saved to 'models/tuned_model_v1+v2+v3_seed42.keras'.
2025-03-23 20:58:19,288 - INFO - Evaluating the best model on the test dataset...
2025-03-23 20:58:34,799 - INFO - Classification Report:
2025-03-23 20:58:34,800 - INFO - {'airplane': {'precision': 0.7062084257206208, 'recall': 0.8493333333333334, 'f1-score': 0.7711864406779662, 'support': 750.0}, 'automobile': {'precision': 0.8463726884779517, 'recall': 0.7933333333333333, 'f1-score': 0.8189951823812801, 'support': 750.0}, 'bird': {'precision': 0.6743869209809265, 'recall': 0.66, 'f1-score': 0.6671159029649596, 'support': 750.0}, 'cat': {'precision': 0.5736543909348442, 'recall': 0.54, 'f1-score': 0.5563186813186813, 'support': 750.0}, 'deer': {'precision': 0.7298937784522003, 'recall': 0.6413333333333333, 'f1-score': 0.6827537260468417, 'support': 750.0}, 'dog': {'precision': 0.6514522821576764, 'recall': 0.628, 'f1-score': 0.639511201629328, 'support': 750.0}, 'frog': {'precision': 0.6455331412103746, 'recall': 0.896, 'f1-score': 0.7504187604690117, 'support': 750.0}, 'horse': {'precision': 0.8578052550231839, 'recall': 0.74, 'f1-score': 0.7945597709377237, 'support': 750.0}, 'ship': {'precision': 0.87701317715959, 'recall': 0.7986666666666666, 'f1-score': 0.8360083740404746, 'support': 750.0}, 'truck': {'precision': 0.8390313390313391, 'recall': 0.7853333333333333, 'f1-score': 0.8112947658402204, 'support': 750.0}, 'accuracy': 0.7332, 'macro avg': {'precision': 0.7401351399148708, 'recall': 0.7332000000000001, 'f1-score': 0.7328162806306489, 'support': 7500.0}, 'weighted avg': {'precision': 0.7401351399148707, 'recall': 0.7332, 'f1-score': 0.7328162806306487, 'support': 7500.0}}
2025-03-23 20:58:34,801 - INFO - Confusion Matrix:
2025-03-23 20:58:34,801 - INFO - [[637  11  27  14  11   5   8   4  20  13]
 [ 21 595   5   1   6   4  24   4  28  62]
 [ 49   6 495  28  33  41  76  13   8   1]
 [ 20   4  37 405  33 127  97  13   8   6]
 [ 22   1  60  53 481  17  78  34   1   3]
 [ 13   1  45 126  27 471  48  12   2   5]
 [  5   0  27  20  14   8 672   3   0   1]
 [ 17   5  28  37  44  42  17 555   0   5]
 [ 79  17   8  12   4   4   9   1 599  17]
 [ 39  63   2  10   6   4  12   8  17 589]]
2025-03-23 20:58:35,380 - INFO - Evaluation report saved to 'reports/evaluation_report_v1+v2+v3_seed42.json'.
2025-03-23 20:58:35,457 - INFO - All partitions processed. Model training complete.
